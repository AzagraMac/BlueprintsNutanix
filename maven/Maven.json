{
   "api_version":"3.0",
   "metadata":{
      "categories":{
         "AppFamily":"DevOps"
      },
      "creation_time":"1557239002783350",
      "kind":"blueprint",
      "last_update_time":"1560412228524748",
      "name":"Maven",
      "spec_version":16
   },
   "spec":{
      "description":"Maven 3.5.4",
      "name":"Maven",
      "resources":{
         "app_profile_list":[
            {
               "action_list":[
                  {
                     "critical":false,
                     "description":"This action will scale in jenkins slaves by given scale in count",
                     "name":"ScaleIn",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"cbb5bcfe_dag"
                        },
                        "name":"19f91eaa_runbook",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"cbb5bcfe_dag",
                              "retries":"0",
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[
                           {
                              "attrs":{
                                 "type":""
                              },
                              "description":"",
                              "editables":{
                                 "value":true
                              },
                              "label":"",
                              "name":"SCALEIN_COUNT",
                              "type":"LOCAL",
                              "val_type":"STRING",
                              "value":"2"
                           }
                        ]
                     },
                     "type":"user"
                  },
                  {
                     "critical":false,
                     "description":"This action will scale out jenkins slaves by given scale out count",
                     "name":"ScaleOut",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"3eff5af2_dag"
                        },
                        "name":"f96ab3d8_runbook",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"3eff5af2_dag",
                              "retries":"0",
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[
                           {
                              "attrs":{
                                 "type":""
                              },
                              "description":"",
                              "editables":{
                                 "value":true
                              },
                              "label":"",
                              "name":"SCALEOUT_COUNT",
                              "type":"LOCAL",
                              "val_type":"STRING",
                              "value":"2"
                           }
                        ]
                     },
                     "type":"user"
                  }
               ],
               "deployment_create_list":[
                  {
                     "action_list":[

                     ],
                     "depends_on_list":[

                     ],
                     "description":"",
                     "max_replicas":"1",
                     "min_replicas":"1",
                     "name":"487f0f9a_deployment_cloned_1",
                     "package_local_reference_list":[
                        {
                           "kind":"app_package",
                           "name":"InstallMaven"
                        }
                     ],
                     "published_service_local_reference_list":[

                     ],
                     "substrate_local_reference":{
                        "kind":"app_substrate",
                        "name":"Maven Machine"
                     },
                     "type":"GREENFIELD",
                     "variable_list":[

                     ]
                  }
               ],
               "description":"",
               "name":"Nutanix",
               "variable_list":[
                  {
                     "attrs":{
                        "is_secret_modified":false,
                        "secret_reference":{

                        },
                        "type":""
                     },
                     "description":"",
                     "editables":{
                        "value":true
                     },
                     "label":"",
                     "name":"AUTHORIZED_KEY",
                     "type":"SECRET",
                     "val_type":"STRING",
                     "value":""
                  },
                  {
                     "attrs":{
                        "is_secret_modified":false,
                        "secret_reference":{

                        },
                        "type":""
                     },
                     "description":"",
                     "label":"",
                     "name":"INSTANCE_PUBLIC_KEY",
                     "type":"SECRET",
                     "val_type":"STRING",
                     "value":""
                  }
               ]
            }
         ],
         "client_attrs":{
            "152f440e-74ed-0886-4cc0-ed04532f693b":{
               "x":-132.5714285714,
               "y":-87.8571428571
            },
            "3ec349e0-fb7a-be2d-c906-0860a48415a9":{
               "x":155.7142857143,
               "y":104
            },
            "487f0f9a_deployment_cloned_1":{
               "x":143.8571428571,
               "y":-90.2857142857
            },
            "7498ddf5-bd3a-4e83-b340-f33a2941223e":{
               "x":300,
               "y":140
            },
            "bd982dcf-8df7-42e2-a223-2cae223151a9":{
               "x":-130,
               "y":104
            },
            "bdb3e39d-afa8-4cdc-a77b-f018d4c4c245":{
               "x":122,
               "y":145
            },
            "d76ba67c-311b-dcb2-3045-2527ebb40319":{
               "x":341.8571428571,
               "y":-259.2857142857
            },
            "dc77b096-5efb-bef1-7817-6e629e323f84":{
               "x":122,
               "y":145
            },
            "e527dc0d-fa65-4914-a257-80a622caa984":{
               "x":122,
               "y":145
            }
         },
         "credential_definition_list":[
            {
               "description":"",
               "editables":{
                  "secret":true,
                  "username":true
               },
               "name":"centos",
               "secret":{
                  "attrs":{
                     "is_secret_modified":false,
                     "secret_reference":{

                     }
                  }
               },
               "type":"KEY",
               "username":"centos"
            }
         ],
         "default_credential_local_reference":{
            "kind":"app_credential",
            "name":"centos"
         },
         "package_definition_list":[
            {
               "action_list":[

               ],
               "description":"",
               "name":"InstallMaven",
               "options":{
                  "install_runbook":{
                     "description":"",
                     "main_task_local_reference":{
                        "kind":"app_task",
                        "name":"5b445cb2_dag_cloned_1"
                     },
                     "message_list":[

                     ],
                     "name":"2ced9004_runbook_cloned_1",
                     "state":"ACTIVE",
                     "task_definition_list":[
                        {
                           "attrs":{
                              "edges":[
                                 {
                                    "edge_type":"user_defined",
                                    "from_task_reference":{
                                       "kind":"app_task",
                                       "name":"InstallPackages"
                                    },
                                    "to_task_reference":{
                                       "kind":"app_task",
                                       "name":"installOpenJDK"
                                    },
                                    "type":""
                                 },
                                 {
                                    "edge_type":"user_defined",
                                    "from_task_reference":{
                                       "kind":"app_task",
                                       "name":"installOpenJDK"
                                    },
                                    "to_task_reference":{
                                       "kind":"app_task",
                                       "name":"installMaven"
                                    },
                                    "type":""
                                 }
                              ],
                              "type":""
                           },
                           "child_tasks_local_reference_list":[
                              {
                                 "kind":"app_task",
                                 "name":"InstallPackages"
                              },
                              {
                                 "kind":"app_task",
                                 "name":"installMaven"
                              },
                              {
                                 "kind":"app_task",
                                 "name":"installOpenJDK"
                              }
                           ],
                           "description":"",
                           "message_list":[

                           ],
                           "name":"5b445cb2_dag_cloned_1",
                           "retries":"0",
                           "state":"ACTIVE",
                           "target_any_local_reference":{
                              "kind":"app_package",
                              "name":"InstallMaven"
                           },
                           "timeout_secs":"0",
                           "type":"DAG",
                           "variable_list":[

                           ]
                        },
                        {
                           "attrs":{
                              "command_line_args":"",
                              "exit_status":[

                              ],
                              "login_credential_local_reference":{
                                 "kind":"app_credential",
                                 "name":"centos"
                              },
                              "script":"#!\/bin\/bash\nset -ex\n\nsudo yum update -y\nsudo yum install -y wget curl vim\nsudo yum clean packages\nsudo yum clean headers\nsudo yum clean metadata\nsudo yum clean all\n",
                              "script_type":"sh",
                              "type":""
                           },
                           "child_tasks_local_reference_list":[

                           ],
                           "description":"",
                           "message_list":[

                           ],
                           "name":"InstallPackages",
                           "retries":"0",
                           "state":"ACTIVE",
                           "target_any_local_reference":{
                              "kind":"app_package",
                              "name":"InstallMaven"
                           },
                           "timeout_secs":"0",
                           "type":"EXEC",
                           "variable_list":[

                           ]
                        },
                        {
                           "attrs":{
                              "command_line_args":"",
                              "exit_status":[

                              ],
                              "login_credential_local_reference":{
                                 "kind":"app_credential",
                                 "name":"centos"
                              },
                              "script":"#!\/bin\/bash\nset -ex\n\ncd \/tmp\nwget http:\/\/10.22.21.134\/packages\/linux\/maven\/apache-maven-3.5.4-bin.tar.gz\ntar -xvf apache-maven-3.5.4-bin.tar.gz\n\nsudo mv \/tmp\/apache-maven-3.5.4\/ \/usr\/local\/src\/apache-maven\/ \n\nsudo echo \"export M2_HOME=\/usr\/local\/src\/apache-maven\nexport PATH=\/usr\/local\/src\/apache-maven\/bin:${PATH}\" >> maven.sh\n\nsudo mv maven.sh \/etc\/profile.d\/\nsudo chmod +x \/etc\/profile.d\/maven.sh \nsource \/etc\/profile.d\/maven.sh\n\ncd ~\/.ssh\/\n\necho '@@{AUTHORIZED_KEY}@@' >> authorized_keys\nsudo chmod 600 authorized_keys",
                              "script_type":"sh",
                              "type":""
                           },
                           "child_tasks_local_reference_list":[

                           ],
                           "description":"",
                           "message_list":[

                           ],
                           "name":"installMaven",
                           "retries":"0",
                           "state":"ACTIVE",
                           "target_any_local_reference":{
                              "kind":"app_service",
                              "name":"Maven"
                           },
                           "timeout_secs":"0",
                           "type":"EXEC",
                           "variable_list":[

                           ]
                        },
                        {
                           "attrs":{
                              "command_line_args":"",
                              "exit_status":[

                              ],
                              "login_credential_local_reference":{
                                 "kind":"app_credential",
                                 "name":"centos"
                              },
                              "script":"#!\/bin\/bash\nset -ex\n\nsudo yum install -y java-1.8.0-openjdk-devel\nsudo ln -s \/usr\/lib\/jvm\/java-1.8.0-openjdk-*\/ \/usr\/jdk8\nexport JAVA_HOME=\/usr\/jdk8",
                              "script_type":"sh",
                              "type":""
                           },
                           "child_tasks_local_reference_list":[

                           ],
                           "description":"",
                           "message_list":[

                           ],
                           "name":"installOpenJDK",
                           "retries":"0",
                           "state":"ACTIVE",
                           "target_any_local_reference":{
                              "kind":"app_service",
                              "name":"Maven"
                           },
                           "timeout_secs":"0",
                           "type":"EXEC",
                           "variable_list":[

                           ]
                        }
                     ],
                     "variable_list":[

                     ]
                  },
                  "type":"",
                  "uninstall_runbook":{
                     "description":"",
                     "main_task_local_reference":{
                        "kind":"app_task",
                        "name":"e915b53d_dag_cloned_1"
                     },
                     "message_list":[

                     ],
                     "name":"cef65be2_runbook_cloned_1",
                     "state":"ACTIVE",
                     "task_definition_list":[
                        {
                           "attrs":{
                              "edges":[

                              ],
                              "type":""
                           },
                           "child_tasks_local_reference_list":[

                           ],
                           "description":"",
                           "message_list":[

                           ],
                           "name":"e915b53d_dag_cloned_1",
                           "retries":"0",
                           "state":"ACTIVE",
                           "target_any_local_reference":{
                              "kind":"app_package",
                              "name":"InstallMaven"
                           },
                           "timeout_secs":"0",
                           "type":"DAG",
                           "variable_list":[

                           ]
                        }
                     ],
                     "variable_list":[

                     ]
                  }
               },
               "service_local_reference_list":[
                  {
                     "kind":"app_service",
                     "name":"Maven"
                  }
               ],
               "type":"DEB",
               "variable_list":[

               ],
               "version":""
            }
         ],
         "published_service_definition_list":[

         ],
         "service_definition_list":[
            {
               "action_list":[
                  {
                     "critical":false,
                     "description":"System action for creating an application",
                     "name":"action_create",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"6867bf21_dag_cloned_1"
                        },
                        "name":"649ebb9f_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"6867bf21_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  },
                  {
                     "critical":false,
                     "description":"System action for deleting an application. Deletes created VMs as well",
                     "name":"action_delete",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"b6f75d2f_dag_cloned_1"
                        },
                        "name":"41524ac0_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"b6f75d2f_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  },
                  {
                     "critical":false,
                     "description":"System action for restarting an application",
                     "name":"action_restart",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"ff4f877b_dag_cloned_1"
                        },
                        "name":"0a872297_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "command_line_args":"",
                                 "exit_status":[

                                 ],
                                 "login_credential_local_reference":{
                                    "kind":"app_credential",
                                    "name":"centos"
                                 },
                                 "script":"#!\/bin\/bash\nset -ex\n\nsudo systemctl start wso2server.service",
                                 "script_type":"sh",
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"Restart WSO2 server",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"EXEC",
                              "variable_list":[

                              ]
                           },
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[
                                 {
                                    "kind":"app_task",
                                    "name":"Restart WSO2 server"
                                 }
                              ],
                              "description":"",
                              "name":"ff4f877b_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  },
                  {
                     "critical":false,
                     "description":"System action for deleting an application. Does not delete created VMs",
                     "name":"action_soft_delete",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"efa70809_dag_cloned_1"
                        },
                        "name":"b64cd6dc_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"efa70809_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  },
                  {
                     "critical":false,
                     "description":"System action for starting an application",
                     "name":"action_start",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"4828f091_dag_cloned_1"
                        },
                        "name":"d23157a1_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"4828f091_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  },
                  {
                     "critical":false,
                     "description":"System action for stopping an application",
                     "name":"action_stop",
                     "runbook":{
                        "description":"",
                        "main_task_local_reference":{
                           "kind":"app_task",
                           "name":"9736c6d3_dag_cloned_1"
                        },
                        "name":"4b4d2d04_runbook_cloned_1",
                        "task_definition_list":[
                           {
                              "attrs":{
                                 "edges":[

                                 ],
                                 "type":""
                              },
                              "child_tasks_local_reference_list":[

                              ],
                              "description":"",
                              "name":"9736c6d3_dag_cloned_1",
                              "retries":"0",
                              "target_any_local_reference":{
                                 "kind":"app_service",
                                 "name":"Maven"
                              },
                              "timeout_secs":"0",
                              "type":"DAG",
                              "variable_list":[

                              ]
                           }
                        ],
                        "variable_list":[

                        ]
                     },
                     "type":"system"
                  }
               ],
               "depends_on_list":[

               ],
               "description":"",
               "name":"Maven",
               "port_list":[

               ],
               "singleton":false,
               "tier":"",
               "variable_list":[

               ]
            }
         ],
         "substrate_definition_list":[
            {
               "action_list":[

               ],
               "create_spec":{
                  "availability_zone_reference":null,
                  "backup_policy":null,
                  "categories":"",
                  "cluster_reference":null,
                  "name":"MVN-@@{calm_array_index}@@-@@{calm_time}@@",
                  "resources":{
                     "boot_config":{
                        "boot_device":{
                           "disk_address":{
                              "adapter_type":"SCSI",
                              "device_index":0,
                              "type":""
                           },
                           "type":""
                        },
                        "mac_address":"",
                        "type":""
                     },
                     "disk_list":[
                        {
                           "data_source_reference":{
                              "kind":"image",
                              "name":"acs-centos",
                              "type":"",
                              "uuid":"2defcfd4-132a-452c-9143-833751984e18"
                           },
                           "device_properties":{
                              "device_type":"DISK",
                              "disk_address":{
                                 "adapter_type":"SCSI",
                                 "device_index":0,
                                 "type":""
                              },
                              "type":""
                           },
                           "disk_size_mib":0,
                           "type":"",
                           "volume_group_reference":null
                        }
                     ],
                     "gpu_list":[

                     ],
                     "guest_customization":{
                        "cloud_init":{
                           "meta_data":"",
                           "type":"",
                           "user_data":"#cloud-config\nusers:\n  - name: centos\n    ssh-authorized-keys:\n      - @@{INSTANCE_PUBLIC_KEY}@@\n    sudo: ['ALL=(ALL) NOPASSWD:ALL']"
                        },
                        "sysprep":null,
                        "type":""
                     },
                     "guest_tools":null,
                     "hardware_clock_timezone":"",
                     "memory_size_mib":4096,
                     "nic_list":[
                        {
                           "ip_endpoint_list":[

                           ],
                           "mac_address":"",
                           "network_function_chain_reference":null,
                           "network_function_nic_type":"INGRESS",
                           "nic_type":"NORMAL_NIC",
                           "subnet_reference":{
                              "kind":"subnet",
                              "name":"",
                              "type":"",
                              "uuid":"4aa08188-f780-4b00-87df-b0ebdc96e0a3"
                           },
                           "type":""
                        }
                     ],
                     "num_sockets":2,
                     "num_vcpus_per_socket":1,
                     "parent_reference":null,
                     "power_state":"ON",
                     "serial_port_list":[

                     ],
                     "type":""
                  },
                  "type":""
               },
               "description":"",
               "editables":{
                  "create_spec":{
                     "name":true,
                     "resources":{
                        "disk_list":{

                        },
                        "guest_customization":true,
                        "memory_size_mib":true,
                        "nic_list":{

                        },
                        "num_sockets":true,
                        "num_vcpus_per_socket":true,
                        "serial_port_list":{

                        }
                     }
                  },
                  "readiness_probe":{
                     "connection_port":true,
                     "timeout_secs":true
                  }
               },
               "name":"Maven Machine",
               "os_type":"Linux",
               "readiness_probe":{
                  "address":"@@{platform.status.resources.nic_list[0].ip_endpoint_list[0].ip}@@",
                  "connection_port":22,
                  "connection_type":"SSH",
                  "delay_secs":"0",
                  "disable_readiness_probe":false,
                  "login_credential_local_reference":{
                     "kind":"app_credential",
                     "name":"centos"
                  }
               },
               "type":"AHV_VM",
               "variable_list":[

               ]
            }
         ],
         "type":"USER"
      }
   },
   "status":{

   }
}